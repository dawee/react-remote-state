#!/usr/bin/env node

const { Server } = require("@react-remote-state/server");
const { program } = require("commander");

program.option("--port <port>", "Port to listen to", "4354");
program.option("--log-level <level>", "Log level", "error");
program.option("--cors-origin", "CORS Origin expression", "*");
program.parse();

let options = program.opts();

let server = new Server({
  port: parseInt(options.port),
  logLevel: options.logLevel,
  io: {
    cors: {
      origin: options.corsOrigin,
      methods: ["GET", "POST"],
    },
    transports: ["websocket"],
  },
});

server.start(() => {
  console.log(`Server listening on port ${server.port}`);
});
